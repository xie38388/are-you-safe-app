name = "are-you-safe-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "are-you-safe-db"
database_id = "YOUR_DATABASE_ID_HERE"  # Replace after running: wrangler d1 create are-you-safe-db

# Environment variables (set via wrangler secret)
# Required secrets:
# - ENCRYPTION_KEY: 32-byte hex string for AES-256-GCM encryption
# - TWILIO_ACCOUNT_SID: Twilio account SID
# - TWILIO_AUTH_TOKEN: Twilio auth token
# - TWILIO_PHONE_NUMBER: Twilio phone number in E.164 format

# Cron triggers for scheduled tasks
[triggers]
crons = ["* * * * *"]  # Run every minute

# Development environment
[env.dev]
name = "are-you-safe-api-dev"

[[env.dev.d1_databases]]
binding = "DB"
database_name = "are-you-safe-db-dev"
database_id = "YOUR_DEV_DATABASE_ID_HERE"

# Production environment
[env.production]
name = "are-you-safe-api"
routes = [
    { pattern = "api.areyousafe.app/*", zone_name = "areyousafe.app" }
]

[[env.production.d1_databases]]
binding = "DB"
database_name = "are-you-safe-db"
database_id = "YOUR_PROD_DATABASE_ID_HERE"
